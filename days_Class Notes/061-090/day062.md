* web.xml 한글 깨짐 방지
```xml
   <filter>
       <filter-name>encodingFilter</filter-name>
       <filter-class>org.springframework.web.filter.CharacterEncodingFilter</filter-class>
       <init-param>
           <param-name>encoding</param-name>
           <param-value>UTF-8</param-value>
       </init-param>
       <init-param>
           <param-name>forceEncoding</param-name>
           <param-value>true</param-value>
       </init-param>
   </filter>
   
   <filter-mapping>
       <filter-name>encodingFilter</filter-name>
       <url-pattern>/*</url-pattern>
   </filter-mapping>  
 ```    


 1. Security
 - 애플리케이션의 보안(인증, 인가) 담당
 - Filter 흐름에 따라 처리

 2. 인증 vs 인가
 - 인증 : Authentication [본인]이 맞는지 확인
 - 인가 : Authorization 인증된 사용자가 [접근가능]

 3. Security 아키텍쳐
=====================
       ② [UsernamePasswordAuthentication Token]
          ↓
① Http Request  →     [AuthenticationFilter] ③ ...  →  [Authentication  Manager]
         ↓⑩               ⑨     ←
          [SecurityContextHolder]
=====================

- 1. 사용자가 로그인 폼태그 시도(username+password 전달)
- 2. UsernamePasswordAuthentication 요청 정보 Authentication을 생성
- 3. Authentication 인증 처리
        [Authentication  Manager]
...
...
- 10. 인증 완료 [사용자정보] SecurityContextHolder 담기
    - AuthenticationSuccessHandler 실행(성공)
    - AuthenticationFailureHandler 실행(실패)    

=====================
[Authentication  Manager] → [Authentication Provider(s)]
=====================
- 4. Authentication Privider(s) : 인증 담당
    1) UsernamePasswordAuthentication token은 provider를 찾는 데 사용
    2) AuthenticationProvider - ★로그인 정보와 db 정보 비교
    3) UserDetailsService - ★ db에 있는 [사용자정보] 가져오기
    

[실습1] 설정
1. pom.xml - security(버전4)
```
      <!-- SECURITY -->
      <!-- SECURITY -->
      <!-- SECURITY -->
      <!-- https://mvnrepository.com/artifact/org.springframework.security/spring-security-core -->
      <dependency>
         <groupId>org.springframework.security</groupId>
         <artifactId>spring-security-web</artifactId>
         <version>4.2.2.RELEASE</version>
         <!-- <version>5.0.7.RELEASE</version> -->
      </dependency>
      <dependency>
         <groupId>org.springframework.security</groupId>
         <artifactId>spring-security-config</artifactId>
         <version>4.2.2.RELEASE</version>
      </dependency>
      <dependency>
         <groupId>org.springframework.security</groupId>
         <artifactId>spring-security-core</artifactId>
         <version>4.2.2.RELEASE</version>
      </dependency>
      <dependency>
         <groupId>org.springframework.security</groupId>
         <artifactId>spring-security-taglibs</artifactId>
         <version>4.2.2.RELEASE</version>
      </dependency>
      <!-- SECURITY -->
      <!-- SECURITY -->
      <!-- SECURITY -->

```


2. security-context.xml

```
 	<security:http>
 		<!-- 디스패처보다 먼저 실행 				모든 경로				무제한허가 -->
 		<security:intercept-url pattern="/security/all"    access="permitAll"/>
 		
 		<security:intercept-url pattern="/security/member" access="hasRole('ROLE_MEMBER')"/>
 		<!-- 로그인폼 필요 -->
 		<security:form-login/>
 	</security:http>

	<security:authentication-manager>	
		<!-- provider : 실제 db상에 있는지 비교 -->
		<security:authentication-provider>
			<!-- 유저 정보 가져오기 -->
			<security:user-service>
			 <security:user name="member" password="member" authorities="ROLE_MEMBER"/>
			</security:user-service>
		</security:authentication-provider>
	</security:authentication-manager>
```


3. web.xml 스프링 구동
```
	<context-param>
		<param-name>contextConfigLocation</param-name>
		<param-value>classpath:/config/*-context.xml</param-value>  ## root-context를 *로 교체
	</context-param>
	
	<filter>
	 <filter-name>springSecurityFilterChain</filter-name>
	 <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
	</filter>
	<filter-mapping>
		<filter-name>springSecurityFilterChain</filter-name>
		<url-pattern>*</url-pattern>
	</filter-mapping>
```

4. SecurityController
5. 테스트    


[실습2] db연동
1. security-context.xml <bean id="" class="bCry...">
2. user-mapper.xml / UserDao / mybatis-config.xml(dto)
 1) 권한 삽입
    insert into authorities(email, auth) values ('1@1.1', 'ROLE_MEMBER')
    insert into authorities(email, auth) values ('1@1.1', 'ROLE_ADMIN')
 2) email, password  권한
    select     u.email, password, auth
    from       appuser  u  left join  authorities a  on  ( u.email = a.email )
    where      u.email = '1@1' 
 3) 회원가입 insert


[실습3] 로그인
1. security-context.xml
        로그인폼
        로그인성공
        로그인실패
        유저정보
2. 설정 내용 - com.thejoa703.security 
3. Controller - 로그인 
4. view - login.jsp
