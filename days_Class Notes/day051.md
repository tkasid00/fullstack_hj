*Spring 작성 주의점

1. 경로 설정 주의
- 오류 : @ContextConfiguration(locations="classpath:config/beans.xml")
- 이렇게 바꿔야됨 : @ContextConfiguration(locations="classpath:com/thejoa703/config/beans.xml")

2. 구동 오류 시 메이븐 업데이트 -> 이후 자바 버전 재확인 해야됨! 


*ver 1. 작성 순서

0. 인터페스 구성  
    [AnimalFarm]  (사용)→    [<<interface>>Animal]   
   ↑(삽입)        ↑(구현)       ↑ (구현)   
    [beans.xml ]  (생성)→     [Cat     /   Dog]

1. 자바 패키지 만들고 인터페이스, 클래스 파일 생성
 - AnimalFarm에서 private 사용 시 gettet/setter 수동 말고 @Data 사용해야 오류 표시 안남!!

2. config 폴더 만들고 beans.xml 만들기
	<!-- Cat  cat       = new Cat() -->
	<bean id="cat" class="com.company.ioctest.Cat"	/>  이렇게 표현

    <property name="name" value="dobby"></property>  -> private String name; 은 value로 받고
	<property name="ani" ref="cat"></property>		 -> Animal ani; 는 ref로 받음

3. 빌드패스 -> 클래스패스 -> JUnit4 테스트 패키지 -> 클래스파일 만들기
- 클래스 위로 임포트할 것들: 
    @RunWith(SpringJUnit4ClassRunner.class)
    @ContextConfiguration(locations="classpath:com/company/config/beans.xml") <- xml 주소

- 클래스 내부 임포트 : 
    @Autowired ApplicationContext context; <-아파치 아님 스프링으로 임포트 주의!!
    @Test public void test1(){} <- 이걸로 구현



*ver 2. 작성 순서    

0. 인터페스 구성  
    [AnimalFarm]  (사용)→    [<<interface>>Animal]   
   ↑(삽입)        ↑(구현)       ↑ (구현)   
    [beans.xml ]  (생성)→     [Cat     /   Dog]

1. 자바 패키지 만들고 인터페이스, 클래스 파일 넣기
- @Component 사용할 것(인터페이스 toString 제거)
- @Component("id값") 은 생략 가능(근데 넣어주면 정확도 올라감)

2. 프로퍼티스 파일 만들기
- properties 파일 없을 시 빈 텍스트파일 작성 후 다른 이름으로 저장 
- 최상단 : #파일명.properties  (ex/ #test2.properties)
- 값 설정하기 : name=butter  /   ani=dog

3. 다시 1번 AnimalFarm으로 돌아가서 프로퍼티스 값 매칭
- name=butter -> @Value("${name}") 	private String name;    <-임포트 할 때 롬복x 스프링o 조심
- ani=dog -> @Resource(name="${ani}")  private Animal ani;
- 프로퍼티스 없을 경우 : @Autowired @Qualifier(name="${ani}")


4. 빈파일 설정 
-	<context:component-scan base-package="com.company.ioctest2"></context:component-scan>
-	<context:property-placeholder location="classpath:com/company/config/test2.properties"	/>

5. 테스트파일 : 1과 동일

※ 오류 발생 시 메이븐 업데이트 + 프로젝트 클린 + 버전 재설정




*db 연동하는 방법

0. pom.xml에 기존 설정 + ojdbc11, spring-jdbc, MYBATIS, HikariCP 추가

1. config 패키지 내 root-context.xml 생성
```
	<context:property-placeholder 
		location="classpath:config/db.properties" />


									<!--클래스 SimpleDriverDataSourc -->
	<bean id="dataSource" class="org.springframework.jdbc.datasource.SimpleDriverDataSource">
	<property name="driverClass" value="${db.driverClass}"></property>
	<property name="url" value="${db.url}"></property>
	<property name="username" value="${db.username}"></property>
	<property name="password" value="${db.password}"></property>
	
	</bean>
```

2. db.properties 생성 (1번과 연결됨)
```
#db.properties
db.driverClass=oracle.jdbc.driver.OracleDriver
db.url=jdbc:oracle:thin:@localhost:1521:xe
db.username=scott
db.password=tiger
```


3. test
- import javax.sql.DataSource; 임포트 조심!!!

```
	@RunWith(SpringJUnit4ClassRunner.class)
	@ContextConfiguration(locations="classpath:config/root-context.xml") 

	public class Test1 {
		
		@Autowired ApplicationContext context;
		@Autowired DataSource datasource;
		@Autowired SqlSession sqlSession;
		
		@Ignore		//@Test 
		public void test1() {System.out.println(context);}
		
		@Ignore		//@Test 
		public void test2() {System.out.println(datasource);}
		
		@Test public void test3() {System.out.println(sqlSession);}
	}		
```

4. mybatis 설정
	1) SqlSessionFactoryBean
		   FactoryBean : 스프링에서 SqlSession 객체 생성 및 관리
		   dataSource : db 연동
		   configLocation : dto 등 설정 
		   mapperLocations : sql 설정
	2) SqlSession: SQL 구문 처리(insert, update, delete, select)

    ```
    <context:component-scan base-package="com.thejoa703"></context:component-scan>  <- 패키지 설정하면 일일이 넣지 않아도 됨    
    <bean id="sqlSessionFactory" class="org.mybatis.spring.SqlSessionFactoryBean" >
		<property name="dataSource" ref="dataSource"></property>
		<property name="configLocation" value="classpath:config/mybatis-config.xml"></property>
		<property name="mapperLocations">
			<list>
			<value>classpath:config/test1-mapper.xml</value>  <-list나 set 이용해서 여러 개 넣어도 됨
            <value>classpath:config/test2-mapper.xml</value>
			</list>
		</property>
	</bean>
	
	<bean id="sqlSession" class="org.mybatis.spring.SqlSessionTemplate">
		<constructor-arg ref="sqlSessionFactory"></constructor-arg>
	</bean>

    ```
    

    3) mxl 설정

    ```
    mybatis-config.xml
        <?xml version="1.0" encoding="UTF-8" ?>
        <!DOCTYPE configuration
        PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-config.dtd">
        <configuration>
        </configuration>

    ```


    ```
    test-mapper.xml
        <?xml version="1.0" encoding="UTF-8" ?>
        <!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
        <mapper namespace=""></mapper>

    ```