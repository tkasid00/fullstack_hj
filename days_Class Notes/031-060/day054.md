1. mvc
- 서로 영향 없이 고칠 수 있는 애플리케이션을 만들 수 있음
- MODEL : DB(TABLE, DTO, DAO, SERVICE)
- VIEW : 화면(html, css, js/jquery)
- CONTROLLER :  MODEL과 VIEW 사이 관리

> MVC1 vs MVC2

>>frontcontroller
[클라이언트] -> [frontcontroller(*.do)]  -> 세부 controller -> view
                                        -> 세부 controller -> view
                                        -> 세부 controller -> view

1. frontcontroller : 공통 작업 먼저 수행
2. 세부 contorller : 작업, view, 최종 결과 생성                       

>>SPRING MVC
[클라이언트] 
    ↓    (ContextLoader)
[frontcontroller]  <<DispatcherServlet>>
    ↓  ↑               ㄴHandler Mapping @Controller -> viw(ViewResolver)
세부 controller 
세부 controller 
세부 controller - db연동

1. 클라이언트 요청
2. DispatcherServlet - Handler Mapping @Contorller
3. Controller 클라이언트 요청 처리 
4. DispatcherServlet - ViewResolver 통해서 응답 결과 처리 

[실습]
1. [pom.xml] - spring-webmvc, jstl/jackson-mapper-asl
2. [web.xml] - ContextLoaderListner(스프링 구동)/DispatcherServlet(경로 처리 FrontController) 
3. [servlet-context.xml] - Controller 위치 설정, ViewResolver
4. [controller] - list.do(처리, view) 설정
5. [view] - 연동


*pom.xml 추가
   
  <!-- https://mvnrepository.com/artifact/org.springframework/spring-webmvc -->
  <dependency>
    <groupId>org.springframework</groupId>
    <artifactId>spring-webmvc</artifactId>
    <version>3.2.17.RELEASE</version>
  </dependency>
  
     <!-- https://mvnrepository.com/artifact/javax.servlet/jstl -->
   <dependency>
      <groupId>javax.servlet</groupId>
      <artifactId>jstl</artifactId>
      <version>1.2</version>
   </dependency>
   
   <dependency>
      <groupId>javax.servlet</groupId>
      <artifactId>jstl</artifactId>
      <version>1.2</version>
   </dependency>
   
   <!-- https://mvnrepository.com/artifact/org.aspectj/aspectjrt -->
   <dependency>
       <groupId>org.aspectj</groupId>
       <artifactId>aspectjrt</artifactId>
       <version>1.7.3</version>
       <!-- <scope>runtime</scope> -->
   </dependency>
   <!-- https://mvnrepository.com/artifact/org.aspectj/aspectjweaver -->
   <dependency>
       <groupId>org.aspectj</groupId>
       <artifactId>aspectjweaver</artifactId>
       <version>1.7.3</version>
      <!-- <scope>runtime</scope> -->
   </dependency>
   <!-- https://mvnrepository.com/artifact/org.springframework/spring-aop -->
   <dependency>
       <groupId>org.springframework</groupId>
       <artifactId>spring-aop</artifactId>
       <version>4.3.28.RELEASE</version>
   </dependency>
   

     <!-- https://mvnrepository.com/artifact/org.codehaus.jackson/jackson-mapper-asl -->
   <dependency>
       <groupId>org.codehaus.jackson</groupId>
       <artifactId>jackson-mapper-asl</artifactId>
       <version>1.9.13</version>
   </dependency>

   <!-- https://mvnrepository.com/artifact/javax.xml.bind/jaxb-api -->
   <dependency>
      <groupId>javax.xml.bind</groupId>
      <artifactId>jaxb-api</artifactId>
      <version>2.3.1</version>
   </dependency>
   <!-- https://mvnrepository.com/artifact/org.glassfish.jaxb/jaxb-core -->
   <dependency>
      <groupId>org.glassfish.jaxb</groupId>
      <artifactId>jaxb-core</artifactId>
      <version>2.3.0.1</version>
   </dependency>
   <!-- https://mvnrepository.com/artifact/com.sun.xml.bind/jaxb-impl -->
   <dependency>
      <groupId>com.sun.xml.bind</groupId>
      <artifactId>jaxb-impl</artifactId>
      <version>2.3.1</version>
   </dependency>   
   

   *서블릿 설정
   ```
   	<!-- mvc 설정 -->
	<context:component-scan base-package="com.thejoa703"	/>
	<mvc:annotation-driven	/>
	<mvc:default-servlet-handler	/>
	
	<!-- ViewResolver view 폴더 안의 jsp 파일 사용-->
	<!-- META-INF 안에 폴더 있을 경우 value="/META-INF/view/"-->
	<bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver">
		<property name="prefix" value="/view/"	/>
		<property name="suffix" value=".jsp"></property>
	</bean>
   ```



   *컨트롤러 

   1. 설계
    /list.quest			/view/quest_board/list.jsp   
    /write.quest			/view/quest_board/write.jsp  (글쓰기폼)
    /detail.quest			/view/quest_board/detail.jsp  (상세보기)
    /edit.quest			/view/quest_board/edit.jsp  (수정폼)
    /delete.quest			/view/quest_board/delete.jsp  (삭제폼)
                                ㄴ/view/, .jsp는 서블릿에 자동으로 붙게 설정해둠

   2. 적용
   ```
   	@RequestMapping("/list.quest")
	public String list() {
		return "/quest_board/list";	
	} 
   ```
   > 프로젝트 -> run on server -> http://localhost:8282/spring005/write.quest 주소 확인                             


   3. 기능별 구분
   ```
   	//글쓰기 폼												디폴트 get
	@RequestMapping(value="/write.quest", method=RequestMethod.GET)
	public String write_get() {
		return "/quest_board/write";
	}
	
	//글쓰기 기능
	@RequestMapping(value="/write.quest", method=RequestMethod.POST)
	public String write_post() {
		return "list.quest";
	}
    ```

    4. 글쓰기 기능 보완
    ```
	@RequestMapping(value="/write.quest", method=RequestMethod.POST)
	public String write_post(RedirectAttributes rttr) {
		String result="글쓰기 실패";
		rttr.addFlashAttribute("success", result);
		
		return "redirect:list.quest";
	}
    ```
    > addFlash : 한 번만 사용(뒤로가기, 앞으로가기 기능 사용해도 다시 뜨지 않게 됨)

    5. list 페이지 스크립트 삽입 - 글쓰기 실패 시 리스트로 돌아오게 만들기
     ``` 
    <script>
	$(function(){
		let result = '${success}';
		console.log(result);
		
		if(result=="글쓰기 실패"){alert(result); history.go(-1);}
		}		
	);
	</script>
    ```
*$ is not defined -> <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script> 헤더에 삽입    