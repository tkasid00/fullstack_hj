<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
	<mapper namespace="com.home.dao.FoodDao">
	<resultMap type="FoodDto" id="FoodMap">
	<result property="foodid"	column="FOODID"/>
	<result property="foodname"	column="FOODNAME"/>
	<result property="brandid"	column="BRANDID"/>
	<result property="description"	column="DESCRIPTION"/>
	<result property="mainingredient"	column="MAININGREDIENT"/>
	<result property="subingredient"	column="SUBINGREDIENT"/>
	<result property="pettypeid"	column="PETTYPEID"/>
	<result property="category"	column="CATEGORY"/>
	<result property="petagegroup"	column="PETAGEGROUP"/>
	<result property="isgrainfree"	column="ISGRAINFREE"/>
	<result property="calorie"	column="CALORIE"/>
	<result property="foodtype"	column="FOODTYPE"/>
	<result property="foodimg"	column="FOODIMG"/>
	<result property="createdat"	column="CREATEDAT"/>
	<result property="updatedat"	column="UPDATEDAT"/>
	<result property="brandname"	column="BRANDNAME"/>
	
	<result property="country"	column="COUNTRY"/>
	<result property="brandtype"	column="BRANDTYPE"/>
	<result property="brandinfo"	column="BRANDINFO"/>
	</resultMap>
	
		




<insert id="foodinsert" parameterType="FoodDto">
    <selectKey keyProperty="foodid" resultType="int" order="BEFORE">
        SELECT food_seq.NEXTVAL FROM dual
    </selectKey>

    INSERT INTO food (
        foodid,
        foodname,
        brandid,
        description,
        mainingredient,
        subingredient,
        pettypeid,
        category,
        petagegroup,
        isgrainfree,
        calorie,
        foodtype,
        foodimg,
        createdat,
        updatedat
    )
    VALUES (
        #{foodid},
        #{foodname},
        #{brandid},
        #{description},
        #{mainingredient},
        #{subingredient},
        #{pettypeid},
        #{category},
        #{petagegroup},
        #{isgrainfree},
        #{calorie},
        #{foodtype},
        #{foodimg},
        sysdate,
        null
    )
</insert>
		<select resultMap="FoodMap"  id="foodselectAll">
		select * from food
		</select>
		
		<select resultMap="FoodMap"    id="foodselectwithBrand" parameterType="int">
		select f.foodid as foodid, f.foodname as foodname, 	
				f.brandid as brandid, 
				f.description as description, 
				f.mainingredient as mainingredient, f.subingredient as subingredient, 
				f.pettypeid as pettypeid, f.category as category, 
				f.petagegroup as petagegroup, f.isgrainfree as isgrainfree, 
				f.calorie as calorie, f.foodtype as foodtype, f.foodimg as foodimg,
				f.createdat as createdat, f.updatedat as updatedat,
				b.brandname as brandname
		from food f join foodbrand b on (f.brandid=b.brandid)
		where foodid=#{foodid} 
		</select>
		
		
		<select resultType="FoodDtoForList"  id="foodselectForList">
		select f.foodid as foodid, f.foodname as foodname, 
        b.brandid as brandid, b.brandname as brandname,
        f.pettypeid as pettypeid,
        TO_CHAR(f.createdat, 'YYYY-MM-DD') as createdat, 
         TO_CHAR(f.updatedat , 'YYYY-MM-DD') as updatedat
		from food f join foodbrand b on(f.brandid=b.brandid)
		order by f.foodid desc
		</select>
		
		
		<select resultMap="FoodMap"    id="foodselect" parameterType="int">
		select * from food where foodid=#{foodid}
		</select>
		
		<update id="foodupdate" parameterType="FoodDto">
		update food set foodname=#{foodname}, brandid=#{brandid}, description=#{description}, 
					mainingredient=#{mainingredient}, subingredient=#{subingredient}, 
						 pettypeid=#{pettypeid}, category=#{category}, petagegroup=#{petagegroup}, 
						 isgrainfree=#{isgrainfree}, calorie=#{calorie}, foodtype=#{foodtype}, foodimg=#{foodimg},
						 updatedat=sysdate  
						 where foodid=#{foodid} 
		</update>
		
		<delete id="fooddelete" parameterType="int">
		delete from food where foodid=#{foodid}
		</delete>
		
	


	</mapper>