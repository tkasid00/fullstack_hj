<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.thejoa703.dao.UserDao">


<resultMap type="UserDto" id="UserMap">
<result property="appUserId"  column="APP_USER_ID"/>
<result property="email"  column="EMAIL"/>
<result property="password"  column="PASSWORD"/>
<result property="mbtiTypeId"  column="MBTI_TYPE_ID"/>
<result property="createdAt"  column="CREATED_AT"/>
<result property="ufile"  column="UFILE"/>
</resultMap>

<insert id="insert" parameterType="UserDto">
insert into appuser(app_user_id, email, password, mbti_type_id, created_at) 
                    values( appuser_seq.nextval, #{email}, #{password}, #{mbtiTypeId}, sysdate)
</insert>

<select  resultMap="UserMap" id="selectAll" >
select * from appuser order by app_user_id desc
</select>

<select resultMap="UserMap"	id="select" parameterType="int">
select * from appuser where app_user_id=#{appUserId}
</select>

<select resultMap="UserMap"	id="selectEmail" parameterType="String">
select * from appuser where email=#{email} 
</select>

<select resultMap="UserMap"	id="selectLogin" parameterType="UserDto">
select * from appuser where email=#{email} and password=#{password}
</select>

<update id="update" parameterType="UserDto">
update appuser set password=#{password}, mbti_type_id=#{mbtiTypeId} 
	where app_user_id=#{appUserId} and password=#{password}
</update>

<delete id="delete" parameterType="UserDto">
delete from appuser where app_user_id=#{appUserId} and password=#{password}
</delete>



<!--이미지 추가 버전-->

<insert id="insertWithImg" parameterType="UserDto">
insert into appuser(app_user_id, email, password, mbti_type_id, created_at, ufile) 
                    values( appuser_seq.nextval, #{email}, #{password}, #{mbtiTypeId}, sysdate, #{ufile})
</insert>


<update id="updateWithImg" parameterType="UserDto">
update appuser set password=#{password}, mbti_type_id=#{mbtiTypeId}, ufile=#{ufile}
	where app_user_id=#{appUserId} and password=#{password}
</update>

</mapper>