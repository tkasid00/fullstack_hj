--리뷰 테이블
CREATE TABLE REVIEW (
    REVIEWID NUMBER PRIMARY KEY,
    USERID NUMBER,
    PASSWORD VARCHAR2(50) NOT NULL,
    BRANDID NUMBER,
    FOODID NUMBER,
    FOODIMG VARCHAR2(300),
    RATING NUMBER(1) CHECK (RATING BETWEEN 1 AND 5),
    TITLE VARCHAR2(100), 
    REVIEWCOMMENT VARCHAR2(500),
    CREATEDAT DATE DEFAULT SYSDATE
);

CREATE SEQUENCE REVIEW_SEQ;

DESC REVIEW;
SELECT * FROM REVIEW;
INSERT INTO REVIEW VALUES(1, 1, '1111', 1, 3, NULL, 5, '잘먹어요', '기호성이 너무 좋아서 우리 애가 돼지가 됐어요', SYSDATE ); 


--라벨영양소 테이블
CREATE TABLE FOODNUTRIENT(
    FOODID NUMBER,
    NUTRIENTID NUMBER,
    AMOUNT NUMBER
);

DESC FOODNUTRIENT;
SELECT * FROM FOODNUTRIENT;
INSERT INTO FOODNUTRIENT VALUES(3, 6, 30);

--영양소 테이블
CREATE TABLE NUTRIENT(
    NUTRIENTID NUMBER PRIMARY KEY,
    NUTRIENTNAME VARCHAR2(100) NOT NULL,
    UNIT VARCHAR2(50) 
);

CREATE SEQUENCE NUTRIENT_SEQ;

DESC NUTRIENT;
SELECT * FROM NUTRIENT;
INSERT INTO NUTRIENT VALUES(6, '단백질', '%');

--범위 테이블
CREATE TABLE NUTRIENTRANGE(
    RANGEID NUMBER PRIMARY KEY,
    PETTYPEID NUMBER,
    NUTRIENTID NUMBER,
    MINVALUE NUMBER NOT NULL,
    MAXVALUE NUMBER NOT NULL,
    RANGELABEL VARCHAR2(50) NOT NULL
);

DESC NUTRIENTRANGE;
SELECT * FROM NUTRIENTRANGE;
INSERT INTO NUTRIENTRANGE VALUES(1, 1, 6, 15, 25, '고양이건사료_저단백');
INSERT INTO NUTRIENTRANGE VALUES(2, 1, 6, 26, 40, '고양이건사료_중단백');
INSERT INTO NUTRIENTRANGE VALUES(3, 1, 6, 41, 55, '고양이건사료_고단백');

--영양소 조인 예시 WHERE <보기 편함
SELECT FOODID, NUTRIENTNAME, AMOUNT, UNIT, RANGELABEL 
FROM  FOODNUTRIENT A, NUTRIENT B ,  NUTRIENTRANGE C
WHERE A.NUTRIENTID = B.NUTRIENTID
AND B.NUTRIENTID = C.NUTRIENTID 
AND A.AMOUNT BETWEEN C.MINVALUE AND C.MAXVALUE ;


--JOIN ON <쓰기 편함
SELECT FOODID, NUTRIENTNAME, AMOUNT, UNIT, RANGELABEL 
FROM  FOODNUTRIENT A 
JOIN NUTRIENT B ON(A.NUTRIENTID = B.NUTRIENTID) 
JOIN NUTRIENTRANGE C ON(B.NUTRIENTID = C.NUTRIENTID 
AND A.AMOUNT BETWEEN C.MINVALUE AND C.MAXVALUE );